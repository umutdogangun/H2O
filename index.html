<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Su Takip ve HatÄ±rlatÄ±cÄ±</title>
    
    <!-- Gerekli KÃ¼tÃ¼phaneler -->
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        /* iOS'ta tÄ±klama gecikmesini Ã¶nlemek iÃ§in */
        html { touch-action: manipulation; }
        body { -webkit-tap-highlight-color: transparent; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // --- Ä°KONLAR (Manuel TanÄ±mlama - Hata Riskini SÄ±fÄ±rlar) ---
        const GlassWater = (props) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}>
                <path d="M15.2 22H8.8a2 2 0 0 1-2-1.79L5 3h14l-1.81 17.21A2 2 0 0 1 15.2 22Z"/><path d="M6 12a5 5 0 0 1 6 0 5 5 0 0 0 6 0"/>
            </svg>
        );
        const Droplets = (props) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}>
                <path d="M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z"/><path d="M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97"/>
            </svg>
        );
        const Bell = (props) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}>
                <path d="M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9"/><path d="M10.3 21a1.94 1.94 0 0 0 3.4 0"/>
            </svg>
        );
        const Heart = (props) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}>
                <path d="M19 14c1.49-1.28 3.6-2.34 4.63-4.27a8.79 8.79 0 0 0-1.2-8.49 9.3 9.3 0 0 0-10.87.27l-.61.53-.61-.53a9.3 9.3 0 0 0-10.87-.27 8.79 8.79 0 0 0-1.2 8.49c1 1.93 3.14 2.99 4.63 4.27 1.83 1.57 3.6 3.16 8.05 7.97 4.45-4.81 6.22-6.4 8.05-7.97z"/>
            </svg>
        );
        const Trophy = (props) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}>
                <path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"/><path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"/><path d="M4 22h16"/><path d="M9 22v-4.66a2 2 0 0 1 1.13-1.8l.87-.44a8 8 0 0 0 5-7.4V3H8v4.7a8 8 0 0 0 5 7.4l.87.44a2 2 0 0 1 1.13 1.8V22"/>
            </svg>
        );
        const RefreshCcw = (props) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}>
                <path d="M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/><path d="M3 3v5h5"/><path d="M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16"/><path d="M16 16h5v5"/>
            </svg>
        );
        const Share = (props) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}>
                <path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"/><polyline points="16 6 12 2 8 6"/><line x1="12" x2="12" y1="2" y2="15"/>
            </svg>
        );
        const WifiOff = (props) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}>
                <line x1="2" y1="2" x2="22" y2="22"/><path d="M8.5 16.429a5 5 0 0 1 7 0"/><path d="M5 12.859a10 10 0 0 1 5.17-2.69"/><path d="M19 12.859a10 10 0 0 0-2.007-1.523"/><path d="M2 8.82a15 15 0 0 1 4.17-2.65"/><path d="M22 8.82a15 15 0 0 0-11.09-2.65"/><path d="M12 20h.01"/>
            </svg>
        );
        const Info = (props) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}>
                <circle cx="12" cy="12" r="10"/><path d="M12 16v-4"/><path d="M12 8h.01"/>
            </svg>
        );


        // --- ANA UYGULAMA KODU ---
        function App() {
            const [waterLevel, setWaterLevel] = useState(0);
            const [goal, setGoal] = useState(2500); // 2.5 Litre hedef
            const [notificationPermission, setNotificationPermission] = useState('default');
            const [showConfetti, setShowConfetti] = useState(false);
            const [isOffline, setIsOffline] = useState(!navigator.onLine);
            const [showInstallHelp, setShowInstallHelp] = useState(false);

            // Mesaj havuzu
            const messages = [
                "GÃ¼naydÄ±n! GÃ¼ne bir bardak suyla baÅŸlamaya ne dersin? â˜€ï¸",
                "Cildinin Ä±ÅŸÄ±ldamasÄ± iÃ§in suya ihtiyacÄ±n var! ğŸ’§",
                "Harika gidiyorsun, bir bardak daha? ğŸ¥¤",
                "Unutma, su iÃ§mek seni daha enerjik yapar! âš¡",
                "GÃ¼nÃ¼n yarÄ±sÄ± bitti, hedefine yaklaÅŸÄ±yorsun! ğŸ¯",
                "Su iÃ§meyi unutma, ben seni dÃ¼ÅŸÃ¼nÃ¼yorum! â¤ï¸"
            ];

            const [currentMessage, setCurrentMessage] = useState(messages[0]);

            useEffect(() => {
                // KayÄ±tlÄ± veriyi yÃ¼kle
                const savedLevel = localStorage.getItem('waterLevel');
                const savedDate = localStorage.getItem('waterDate');
                const today = new Date().toDateString();

                if (savedDate === today && savedLevel) {
                    setWaterLevel(parseInt(savedLevel));
                } else {
                    // Yeni gÃ¼n, sÄ±fÄ±rla
                    setWaterLevel(0);
                    localStorage.setItem('waterDate', today);
                }

                // Bildirim izni kontrolÃ¼
                if ('Notification' in window) {
                    setNotificationPermission(Notification.permission);
                }

                // Rastgele mesaj seÃ§
                const randomMsg = messages[Math.floor(Math.random() * messages.length)];
                setCurrentMessage(randomMsg);

                // Ã‡evrimdÄ±ÅŸÄ±/Ã‡evrimiÃ§i takibi
                const handleOnline = () => setIsOffline(false);
                const handleOffline = () => setIsOffline(true);
                window.addEventListener('online', handleOnline);
                window.addEventListener('offline', handleOffline);

                return () => {
                    window.removeEventListener('online', handleOnline);
                    window.removeEventListener('offline', handleOffline);
                };
            }, []);

            // ZAMANLANMIÅ BÄ°LDÄ°RÄ°M VE SES KONTROLÃœ
            useEffect(() => {
                const checkTimeAndNotify = () => {
                    if (notificationPermission !== 'granted') return;

                    const now = new Date();
                    // Saati ve dakikayÄ± HH:MM formatÄ±na getir (Ã¶rn: 09:00)
                    const currentTime = `${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}`;
                    
                    // GÃ¶nderilecek Mesajlar ve Saatler
                    const schedule = {
                        "09:00": "GÃœNAYDIN! Bol su iÃ§meyi unutma :)",
                        "13:00": "Yeterince su iÃ§iyor musun?",
                        "17:30": "BugÃ¼n kaÃ§ L su iÃ§tin?"
                    };

                    // EÄŸer ÅŸu anki saat listede varsa ve mesajÄ± varsa
                    if (schedule[currentTime]) {
                        // Son bildirim atÄ±lan zamanÄ± kontrol et (aynÄ± dakika iÃ§inde tekrar atmasÄ±n)
                        const lastNotified = localStorage.getItem('lastNotificationTime');
                        
                        if (lastNotified !== currentTime) {
                            // 1. Bildirimi GÃ¶nder
                            new Notification("Su HatÄ±rlatÄ±cÄ±sÄ±", { 
                                body: schedule[currentTime],
                                icon: "https://cdn-icons-png.flaticon.com/512/3105/3105807.png"
                            });

                            // 2. Su Sesini Ã‡al (Mixkit Ã¼cretsiz ses kaynaÄŸÄ±)
                            const audio = new Audio('https://assets.mixkit.co/sfx/preview/mixkit-water-pouring-into-glass-2004.mp3');
                            audio.volume = 0.6; // Ses seviyesi %60
                            audio.play().catch(e => console.log("Otomatik ses Ã§alma tarayÄ±cÄ± tarafÄ±ndan engellendi."));

                            // 3. Bu saati kaydet ki tekrar atmasÄ±n
                            localStorage.setItem('lastNotificationTime', currentTime);
                        }
                    }
                };

                // Her 15 saniyede bir saati kontrol et
                const timer = setInterval(checkTimeAndNotify, 15000);
                
                // Temizlik
                return () => clearInterval(timer);
            }, [notificationPermission]);

            const saveProgress = (newLevel) => {
                setWaterLevel(newLevel);
                localStorage.setItem('waterLevel', newLevel);
                localStorage.setItem('waterDate', new Date().toDateString());
                
                if (newLevel >= goal) {
                    triggerCelebration();
                }
            };

            const addWater = (amount) => {
                const newLevel = waterLevel + amount;
                saveProgress(newLevel);
                requestNotification(`HarikasÄ±n! ${amount}ml daha eklendi. Hedefe ${Math.max(0, goal - newLevel)}ml kaldÄ±.`);
            };

            const resetDay = () => {
                if(confirm("BugÃ¼nkÃ¼ takibi sÄ±fÄ±rlamak istiyor musun?")) {
                    saveProgress(0);
                }
            };

            const triggerCelebration = () => {
                setShowConfetti(true);
                setTimeout(() => setShowConfetti(false), 3000);
            };

            const requestNotificationAccess = async () => {
                if (!('Notification' in window)) {
                    alert("Bu tarayÄ±cÄ± bildirimleri desteklemiyor.");
                    return;
                }
                const permission = await Notification.requestPermission();
                setNotificationPermission(permission);
                if (permission === 'granted') {
                    new Notification("Bildirimler AÃ§Ä±k!", {
                        body: "Seni susuz bÄ±rakmayacaÄŸÄ±m! ğŸ’™",
                        icon: "https://cdn-icons-png.flaticon.com/512/3105/3105807.png"
                    });
                }
            };

            const requestNotification = (text) => {
                if (notificationPermission === 'granted') {
                new Notification("Su HatÄ±rlatÄ±cÄ±sÄ±", { body: text });
                }
            };

            // Ä°lerleme yÃ¼zdesi
            const progress = Math.min(100, (waterLevel / goal) * 100);

            return (
                <div className="min-h-screen bg-blue-50 flex flex-col items-center py-8 px-4 font-sans text-slate-700 relative overflow-hidden select-none touch-manipulation">
                
                {/* Konfeti Efekti */}
                {showConfetti && (
                    <div className="absolute inset-0 pointer-events-none z-50 flex justify-center items-start pt-20">
                    <div className="text-6xl animate-bounce">ğŸ‰ğŸ’§ğŸ‰</div>
                    </div>
                )}

                {/* Kurulum Rehberi Modal */}
                {showInstallHelp && (
                    <div className="fixed inset-0 bg-black/60 z-50 flex items-center justify-center p-4 backdrop-blur-sm" onClick={() => setShowInstallHelp(false)}>
                    <div className="bg-white rounded-3xl p-6 max-w-sm w-full shadow-2xl relative" onClick={e => e.stopPropagation()}>
                        <button onClick={() => setShowInstallHelp(false)} className="absolute top-4 right-4 text-slate-400 hover:text-slate-600">âœ•</button>
                        <h3 className="text-xl font-bold text-slate-800 mb-4 flex items-center gap-2">
                        <span className="bg-blue-100 p-1 rounded">ğŸ“±</span> UygulamayÄ± YÃ¼kle
                        </h3>
                        <ol className="text-sm text-slate-600 space-y-4">
                        <li className="flex gap-3 items-start">
                            <span className="bg-slate-100 px-2 py-0.5 rounded font-bold text-slate-500">1</span>
                            <span>Alttaki <Share className="inline w-4 h-4 text-blue-500"/> <strong>PaylaÅŸ</strong> butonuna bas.</span>
                        </li>
                        <li className="flex gap-3 items-start">
                            <span className="bg-slate-100 px-2 py-0.5 rounded font-bold text-slate-500">2</span>
                            <span>Listeyi yukarÄ± kaydÄ±r ve <br/><strong>"Ana Ekrana Ekle"</strong>yi seÃ§.</span>
                        </li>
                        <li className="flex gap-3 items-start">
                            <span className="bg-slate-100 px-2 py-0.5 rounded font-bold text-slate-500">3</span>
                            <span>SaÄŸ Ã¼stteki <strong>Ekle</strong> butonuna bas.</span>
                        </li>
                        </ol>
                        <div className="mt-6 bg-blue-50 p-3 rounded-xl text-xs text-blue-600 font-medium text-center">
                        ArtÄ±k internet olmasa bile ana ekranÄ±ndan Ã§alÄ±ÅŸtÄ±rabilirsin!
                        </div>
                    </div>
                    </div>
                )}

                {/* Header */}
                <header className="w-full max-w-md flex justify-between items-center mb-6">
                    <div className="flex items-center gap-2">
                    <div className="bg-gradient-to-tr from-blue-500 to-blue-400 p-2.5 rounded-2xl shadow-lg shadow-blue-200">
                        <Droplets className="text-white w-6 h-6" />
                    </div>
                    <div>
                        <h1 className="font-bold text-xl text-slate-800 tracking-tight">Su Takibi</h1>
                        <div className="flex items-center gap-1">
                        <p className="text-xs text-slate-500 font-medium">SaÄŸlÄ±klÄ± YaÅŸam</p>
                        {isOffline && <span className="text-[10px] bg-slate-200 text-slate-600 px-1.5 py-0.5 rounded-full flex items-center gap-1"><WifiOff size={10}/> Ã‡evrimdÄ±ÅŸÄ±</span>}
                        </div>
                    </div>
                    </div>
                    
                    <div className="flex gap-2">
                    <button 
                        onClick={() => setShowInstallHelp(true)}
                        className="bg-white p-2.5 rounded-full shadow-md hover:bg-blue-50 transition border border-blue-50 text-blue-500"
                        title="NasÄ±l YÃ¼klenir?"
                    >
                        <Info className="w-5 h-5" />
                    </button>
                    
                    {notificationPermission !== 'granted' && (
                        <button 
                        onClick={requestNotificationAccess}
                        className="bg-white p-2.5 rounded-full shadow-md hover:bg-blue-50 transition border border-blue-50"
                        >
                        <Bell className="w-5 h-5 text-blue-500" />
                        </button>
                    )}
                    </div>
                </header>

                {/* Mesaj KartÄ± */}
                <div className="w-full max-w-md bg-white p-5 rounded-3xl shadow-sm border border-blue-100 mb-8 flex gap-4 items-center">
                    <div className="bg-pink-50 p-2 rounded-full">
                        <Heart className="text-pink-500 w-5 h-5 flex-shrink-0" fill="currentColor" />
                    </div>
                    <p className="text-sm font-medium text-slate-600 italic leading-relaxed">"{currentMessage}"</p>
                </div>

                {/* Ana GÃ¶sterge (Circle Progress) */}
                <div className="relative w-72 h-72 mb-10 flex items-center justify-center">
                    {/* DÄ±ÅŸ Ã‡ember GÃ¶lgesi */}
                    <div className="absolute inset-0 rounded-full bg-blue-100 blur-3xl opacity-30"></div>
                    
                    <svg className="w-full h-full transform -rotate-90 drop-shadow-xl">
                    <circle
                        cx="144"
                        cy="144"
                        r="120"
                        stroke="white"
                        strokeWidth="20"
                        fill="transparent"
                        className="opacity-60"
                    />
                    <circle
                        cx="144"
                        cy="144"
                        r="120"
                        stroke="url(#blue-gradient)"
                        strokeWidth="20"
                        fill="transparent"
                        strokeDasharray={754} 
                        strokeDashoffset={754 - (754 * progress) / 100}
                        className="transition-all duration-1000 ease-out"
                        strokeLinecap="round"
                    />
                    <defs>
                        <linearGradient id="blue-gradient" x1="0%" y1="0%" x2="100%" y2="0%">
                        <stop offset="0%" stopColor="#3b82f6" />
                        <stop offset="100%" stopColor="#60a5fa" />
                        </linearGradient>
                    </defs>
                    </svg>
                    
                    {/* Ä°Ã§erik */}
                    <div className="absolute flex flex-col items-center">
                    <span className="text-6xl font-black text-slate-800 tracking-tighter mb-1">{waterLevel}</span>
                    <span className="text-sm text-slate-400 font-bold uppercase tracking-wide mb-3">/ {goal} ml</span>
                    {waterLevel >= goal ? (
                        <div className="animate-bounce flex items-center gap-1 text-green-600 font-bold bg-green-100 px-4 py-1.5 rounded-full text-xs shadow-sm">
                            <Trophy className="w-3 h-3" /> HEDEF TAMAM!
                        </div>
                    ) : (
                        <div className="text-xs text-blue-400 font-medium bg-blue-50 px-3 py-1 rounded-full">
                        %{Math.round(progress)} TamamlandÄ±
                        </div>
                    )}
                    </div>
                </div>

                {/* Butonlar */}
                <div className="grid grid-cols-2 gap-5 w-full max-w-md mb-8 px-2">
                    <button 
                    onClick={() => addWater(200)}
                    className="group relative bg-white hover:bg-blue-500 active:bg-blue-600 transition-all duration-300 p-5 rounded-3xl flex flex-col items-center shadow-md hover:shadow-blue-200/50 active:scale-95 border border-slate-50"
                    >
                    <div className="bg-blue-50 group-hover:bg-white/20 p-3 rounded-2xl mb-3 transition-colors">
                        <GlassWater className="w-6 h-6 text-blue-500 group-hover:text-white transition-colors" />
                    </div>
                    <span className="font-bold text-lg text-slate-700 group-hover:text-white">+200 ml</span>
                    <span className="text-xs text-slate-400 group-hover:text-blue-100">Bir Bardak</span>
                    </button>

                    <button 
                    onClick={() => addWater(500)}
                    className="group relative bg-white hover:bg-blue-600 active:bg-blue-700 transition-all duration-300 p-5 rounded-3xl flex flex-col items-center shadow-md hover:shadow-blue-200/50 active:scale-95 border border-slate-50"
                    >
                    <div className="absolute -top-2 -right-2 w-4 h-4 bg-red-400 rounded-full animate-pulse border-2 border-blue-50"></div>
                    <div className="bg-blue-50 group-hover:bg-white/20 p-3 rounded-2xl mb-3 transition-colors">
                        <Droplets className="w-6 h-6 text-blue-600 group-hover:text-white transition-colors" />
                    </div>
                    <span className="font-bold text-lg text-slate-700 group-hover:text-white">+500 ml</span>
                    <span className="text-xs text-slate-400 group-hover:text-blue-100">Bir ÅiÅŸe</span>
                    </button>
                </div>

                {/* Alt Bilgi & SÄ±fÄ±rlama */}
                <div className="mt-auto w-full max-w-md flex justify-between items-center text-xs text-slate-400 px-4 pb-4">
                    <p className="font-medium">Senin iÃ§in â¤ï¸</p>
                    <button onClick={resetDay} className="flex items-center gap-1.5 hover:text-red-400 transition bg-white px-3 py-1.5 rounded-full shadow-sm border border-slate-100">
                    <RefreshCcw className="w-3 h-3" /> SÄ±fÄ±rla
                    </button>
                </div>

                </div>
            );
        }

        // UygulamayÄ± BaÅŸlat
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>